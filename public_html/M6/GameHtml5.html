<html><head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title></title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="robots" content="noindex, nofollow">
  <meta name="googlebot" content="noindex, nofollow">
  <meta name="viewport" content="width=device-width, initial-scale=1">


  <script type="text/javascript" src="/js/lib/dummy.js"></script>

    <link rel="stylesheet" type="text/css" href="/css/result-light.css">


  <style id="compiled-css" type="text/css">
    #canvas {
  width: 600px;
  height: 400px;
  border: 1px solid black;
}


    /* EOS */
  </style>

  <script id="insert"></script>

</head>
<body>
    <canvas id="canvas" width="600" height="400" tabindex="1"></canvas>


    <script type="text/javascript">//<![CDATA[


// Arcade Shooter game

// Get a reference to the canvas DOM element
var canvas = document.getElementById('canvas');
// Get the canvas drawing context
var context = canvas.getContext('2d');

// Create an object representing a square on the canvas
function makeSquare(x, y, length, speed) {
  return {
    x: x,
    y: y,
    l: length,
    s: speed,
    draw: function() {
      context.fillRect(this.x, this.y, this.l, this.l);
    }
  };
}

// The ship the user controls
var ship = makeSquare(50, canvas.height / 2 - 25, 50, 5);

// Flags to tracked which keys are pressed
var up = false;
var down = false;
var left = false;
var right = false;
var space = false;

// Is a bullet already on the canvas?
var shooting = false;

//ptp25 11/09/22

// The bullet shot from the ship
var bullets = [];
bullets.push(makeSquare(0, 0, 10, 15));
bullets.push(makeSquare(0, 0, 10, 15));
bullets.push(makeSquare(0, 0, 10, 15));
bullets.push(makeSquare(0, 0, 10, 15));
bullets.push(makeSquare(0, 0, 10, 15));

// An array for enemies (in case there are more than one)
var enemies = [];

// Add an enemy object to the array
var enemyBaseSpeed = 2;
function makeEnemy() {
  var enemyX = canvas.width;
  var enemySize = Math.round((Math.random() * 15)) + 15;
  var enemyY = Math.round(Math.random() * (canvas.height - enemySize * 2)) + enemySize;
  var enemySpeed = Math.round(Math.random() * enemyBaseSpeed) + enemyBaseSpeed;
  enemies.push(makeSquare(enemyX, enemyY, enemySize, enemySpeed));
}

var PowerUp = [];
var powered = false;
var powerupshots = 5;

var powerUpBaseSpeed = 2;
function makePowerUp() {
  var powerUpX = canvas.width;
  var powerUpSize = Math.round((Math.random() * 15)) + 15;
  var powerUpY = Math.round(Math.random() * (canvas.height - powerUpSize * 2)) + powerUpSize;
  var powerUpSpeed = Math.round(Math.random() * powerUpBaseSpeed) + powerUpBaseSpeed;
  PowerUp.push(makeSquare(powerUpX, powerUpY, powerUpSize, powerUpSpeed));
}

// Check if number a is in the range b to c (exclusive)
function isWithin(a, b, c) {
  return (a > b && a < c);
}

// Return true if two squares a and b are colliding, false otherwise
function isColliding(a, b) {
  var result = false;
  if (isWithin(a.x, b.x, b.x + b.l) || isWithin(a.x + a.l, b.x, b.x + b.l)) {
    if (isWithin(a.y, b.y, b.y + b.l) || isWithin(a.y + a.l, b.y, b.y + b.l)) {
      result = true;
    }
  }
  return result;
}

// Track the user's score
var score = 0;
// The delay between enemies (in milliseconds)
var timeBetweenEnemies = 5 * 1000;

// The delay between power ups (in milliseconds)
var timeBetweenPowerUps = 10 * 1000;

// ID to track the spawn timeout
var timeoutId = null;

// Show the game menu and instructions
function menu() {
  erase();
  context.fillStyle = '#000000';
  context.font = '36px Arial';
  context.textAlign = 'center';
  context.fillText('Shoot \'Em!', canvas.width / 2, canvas.height / 4);
  context.font = '24px Arial';
  context.fillText('Click to Start', canvas.width / 2, canvas.height / 2);
  context.font = '18px Arial';
  context.fillText('Up/Down to move, Space to shoot.', canvas.width / 2, (canvas.height / 4) * 3);
  // Start the game on a click
  canvas.addEventListener('click', startGame);
}

// Start the game
function startGame() {
	// Kick off the enemy spawn interval
  timeoutId = setInterval(makeEnemy, timeBetweenEnemies);

  // Kick off the power up spawn interval
  timeoutId = setInterval(makePowerUp, timeBetweenPowerUps);

  // Make the first enemy
  setTimeout(makeEnemy, 1000);

  // Make the first power up
  setTimeout(makePowerUp, 1000);

  // Kick off the draw loop
  draw();
  // Stop listening for click events
  canvas.removeEventListener('click', startGame);
}

// Show the end game screen
function endGame() {
	// Stop the spawn interval
  clearInterval(timeoutId);
  // Show the final score
  erase();
  context.fillStyle = '#000000';
  context.font = '24px Arial';
  context.textAlign = 'center';
  context.fillText('Game Over. Final Score: ' + score, canvas.width / 2, canvas.height / 2);
}

//ptp25 11/09/22

// Listen for keydown events
canvas.addEventListener('keydown', function(event) {
  event.preventDefault();
  if (event.keyCode === 38) { // UP
    up = true;
  }
  if (event.keyCode === 40) { // DOWN
    down = true;
  }
  //move left
  if (event.keyCode === 37) { // LEFT
    left = true;
  }
  //move right
  if (event.keyCode === 39) { // RIGHT
    right = true;
  }

  if (event.keyCode === 32) { // SPACE
    shoot();
  }
});

// Listen for keyup events
canvas.addEventListener('keyup', function(event) {
  event.preventDefault();
  if (event.keyCode === 38) { // UP 
    up = false;
  }
  if (event.keyCode === 40) { // DOWN
    down = false;
  }
  //move left
  if (event.keyCode === 37) { // LEFT
    left = false;
  }
  //move right
  if (event.keyCode === 39) { // RIGHT
    right = false;
  }

});

// Clear the canvas
function erase() {
  context.fillStyle = '#FFFFFF';
  context.fillRect(0, 0, 600, 400);
}


//ptp25 11/09/22

// Shoot the bullet (if not already on screen)
function shoot() {
  if (!shooting && !powered) {
    shooting = true;
    bullets[0].x = ship.x + ship.l;
    bullets[0].y = ship.y + ship.l / 2;
  }
  else if (!shooting && powered) {
    shooting = true;
    bullets.forEach(function(bullet) {
      bullet.x = ship.x + ship.l;
      bullet.y = ship.y + ship.l / 2;
    });
    if(powerupshots==0){
      powered = false;
      powerupshots = 5;
    }
    else{
      powerupshots--;
    }

  }

}

// The main draw loop
function draw() {
  erase();
  var gameOver = false;

  // Move and draw powerups
  if(!powered){
    PowerUp.forEach(function(powerUp) {
      powerUp.x -= powerUp.s;
      context.fillStyle = '#0000FF';
      powerUp.draw();
    });
  }

  // Collide the ship with the powerups
  PowerUp.forEach(function(powerUp, i) {
    if (isColliding(ship, powerUp)) {
      PowerUp.splice(i, 1);
      console.log("powered up");
      powered = true;
    }
  });

  // Move and draw the enemies
  enemies.forEach(function(enemy) {
    enemy.x -= enemy.s;
    if (enemy.x < 0) {
      gameOver = true;
    }
    context.fillStyle = '#00FF00';
    enemy.draw();
  });
  // Collide the ship with enemies
  enemies.forEach(function(enemy, i) {
    if (isColliding(enemy, ship)) {
      gameOver = true;
    }
  });
  // Move the ship
  if (down) {
    ship.y += ship.s;
  }
  if (up) {
    ship.y -= ship.s;
  }
  if (left) {
    ship.x -= ship.s;
  }
  if (right) {
    ship.x += ship.s;
  }
  // Don't go out of bounds
  if (ship.y < 0) {
    ship.y = 0;
  }
  if (ship.y > canvas.height - ship.l) {
    ship.y = canvas.height - ship.l;
  }

  //ptp25 11/09/2022

  if (ship.x < 0) {
    ship.x = 0;
  }
  if (ship.x > canvas.width - ship.l) {
    ship.x = canvas.width - ship.l;
  }
  // Draw the ship
  context.fillStyle = '#FF0000';
  ship.draw();
  // Move and draw the bullet

  //ptp25 11/09/22

  // if shooting and not powered
  if (shooting && !powered) {
    
    // Move the bullet
    bullets[0].x += bullets[0].s;
    // Collide the bullet with enemies
    enemies.forEach(function(enemy, i) {
      if (isColliding(bullets[0], enemy)) {
        enemies.splice(i, 1);
        score++;
        shooting = false;
        // Make the game harder
        if (score % 10 === 0 && timeBetweenEnemies > 1000) {
          clearInterval(timeoutId);
          timeBetweenEnemies -= 1000;
          timeoutId = setInterval(makeEnemy, timeBetweenEnemies);
        } else if (score % 5 === 0) {
          enemyBaseSpeed += 1;
        }
      }
    });
    // Collide with the wall
    if (bullets[0].x > canvas.width) {
      shooting = false;
    }
    // Draw the bullet
    context.fillStyle = '#0000FF';
    bullets[0].draw();
  }

  if (shooting && powered) {
    // Move the bullet
    bullets[0].x += bullets[0].s;

    bullets[1].x += bullets[1].s;
    bullets[1].y += bullets[1].s/2;


    bullets[2].x += bullets[2].s;
    bullets[2].y += bullets[2].s/4;

    bullets[3].x += bullets[3].s;
    bullets[3].y -= bullets[3].s/2;

    bullets[4].x += bullets[4].s;
    bullets[4].y -= bullets[4].s/4;

    // Collide the bullet with enemies
    bullets.forEach(function(bullet) {
      enemies.forEach(function(enemy, i) {
      if (isColliding(bullet, enemy)) {
        enemies.splice(i, 1);
        score++;
        shooting = false;
        // Make the game harder
        if (score % 10 === 0 && timeBetweenEnemies > 1000) {
          clearInterval(timeoutId);
          timeBetweenEnemies -= 1000;
          timeoutId = setInterval(makeEnemy, timeBetweenEnemies);
        } else if (score % 5 === 0) {
          enemyBaseSpeed += 1;
        }
      }
    });
    // Collide with the wall
    if (bullet.x > canvas.width) {
      shooting = false;
    }
    // Draw the bullet
    context.fillStyle = '#0000FF';
    bullet.draw();
    });
    
  }
  // Draw the score
  context.fillStyle = '#000000';
  context.font = '24px Arial';
  context.textAlign = 'left';
  context.fillText('Score: ' + score, 1, 25)
  // End or continue the game
  if (gameOver) {
    endGame();
  } else {
    window.requestAnimationFrame(draw);
  }
}

// Start the game
menu();
canvas.focus();



  //]]></script>

  <script>
    // tell the embed parent frame the height of the content
    if (window.parent && window.parent.parent){
      window.parent.parent.postMessage(["resultsFrame", {
        height: document.body.getBoundingClientRect().height,
        slug: "5c24y0Lp"
      }], "*")
    }

    // always overwrite window.name, in case users try to set it manually
    window.name = "result"
  </script>




</body></html>